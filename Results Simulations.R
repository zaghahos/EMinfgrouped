MLEbinned50m8<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MLE/mlebinned50m8.csv")
MLEbinned50m15<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MLE/mlebinned50m15.csv")
MLEbinned50m30<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MLE/mlebinned50m30.csv")
MLEbinned100m8<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MLE/mlebinned100m8.csv")
MLEbinned100m15<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MLE/mlebinned100m15.csv")
MLEbinned100m30<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MLE/mlebinned100m30.csv")
MLEbinned300m8<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MLE/mlebinned300m8.csv")
MLEbinned300m15<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MLE/mlebinned300m15.csv")
MLEbinned300m30<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MLE/mlebinned300m30.csv")
MLEbinned600m8<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MLE/mlebinned600m8.csv")
MLEbinned600m15<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MLE/mlebinned600m15.csv")
MLEbinned600m30<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MLE/mlebinned600m30.csv")
MLEbinned1000m8<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MLE/mlebinned1000m8.csv")
MLEbinned1000m15<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MLE/mlebinned1000m15.csv")
MLEbinned1000m30<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MLE/mlebinned1000m30.csv")

MLEbinned50m8<- MLEbinned50m8[,-1]
MLEbinned50m15<- MLEbinned50m15[,-1]
MLEbinned50m30<- MLEbinned50m30[,-1]
MLEbinned100m8<- MLEbinned100m8[,-1]
MLEbinned100m15<- MLEbinned100m15[,-1]
MLEbinned100m30<- MLEbinned100m30[,-1]
MLEbinned300m8<- MLEbinned300m8[,-1]
MLEbinned300m15<- MLEbinned300m15[,-1]
MLEbinned300m30<- MLEbinned300m30[,-1]
MLEbinned600m8<- MLEbinned600m8[,-1]
MLEbinned600m15<- MLEbinned600m15[,-1]
MLEbinned600m30<- MLEbinned600m30[,-1]
MLEbinned1000m8<- MLEbinned1000m8[,-1]
MLEbinned1000m15<- MLEbinned1000m15[,-1]
MLEbinned1000m30<- MLEbinned1000m30[,-1]



#############################################################################################################
outputEM50m8<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/EM/out50m8EM.csv")
outputEM100m8<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/EM/out100m8EM.csv")
outputEM300m8<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/EM/out300m8EM.csv")
outputEM600m8<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/EM/out600m8EM.csv")
outputEM1000m8<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/EM/out1000m8EM.csv")



outputEM50m8<- outputEM50m8[,-1]
outputEM100m8<- outputEM100m8[,-1]
outputEM300m8<- outputEM300m8[,-1]
outputEM600m8<- outputEM600m8[,-1]
outputEM1000m8<- outputEM1000m8[,-1]


outputEM50m30<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/EM/out50m30EM.csv")
outputEM100m30<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/EM/out100m30EM.csv")
outputEM300m30<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/EM/out300m30EM.csv")
outputEM600m30<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/EM/out600m30EM.csv")
outputEM1000m30<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/EM/out1000m30EM.csv")



outputEM50m30<- outputEM50m30[,-1]
outputEM100m30<- outputEM100m30[,-1]
outputEM300m30<- outputEM300m30[,-1]
outputEM600m30<- outputEM600m30[,-1]
outputEM1000m30<- outputEM1000m30[,-1]

outputEM50m15<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/EM/out50m15EM.csv")
outputEM100m15<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/EM/out100m15EM.csv")
outputEM300m15<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/EM/out300m15EM.csv")
outputEM600m15<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/EM/out600m15EM.csv")
outputEM1000m15<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/EM/out1000m15EM.csv")



outputEM50m15<- outputEM50m15[,-1]
outputEM100m15<- outputEM100m15[,-1]
outputEM300m15<- outputEM300m15[,-1]
outputEM600m15<- outputEM600m15[,-1]
outputEM1000m15<- outputEM1000m15[,-1]
###############################################################################################################

outputMCEM50m8<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MCEM/outMCEM50m8.csv")
outputMCEM100m8<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MCEM/outMCEM100m8.csv")
outputMCEM300m8<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MCEM/outMCEM300m8.csv")
outputMCEM600m8<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MCEM/outMCEM600m8.csv")
outputMCEM1000m8<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MCEM/outMCEM1000m8.csv")



outputMCEM50m8<- outputMCEM50m8[,-1]
outputMCEM100m8<- outputMCEM100m8[,-1]
outputMCEM300m8<- outputMCEM300m8[,-1]
outputMCEM600m8<- outputMCEM600m8[,-1]
outputMCEM1000m8<- outputMCEM1000m8[,-1]


outputMCEM50m30<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MCEM/outMCEM50m30.csv")
outputMCEM100m30<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MCEM/outMCEM100m30.csv")
outputMCEM300m30<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MCEM/outMCEM300m30.csv")
outputMCEM600m30<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MCEM/outMCEM600m30.csv")
outputMCEM1000m30<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MCEM/outMCEM1000m30.csv")



outputMCEM50m30<- outputMCEM50m30[,-1]
outputMCEM100m30<- outputMCEM100m30[,-1]
outputMCEM300m30<- outputMCEM300m30[,-1]
outputMCEM600m30<- outputMCEM600m30[,-1]
outputMCEM1000m30<- outputMCEM1000m30[,-1]






outputMCEM50m15<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MCEM/outMCEM50m15.csv")
outputMCEM100m15<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MCEM/outMCEM100m15.csv")
outputMCEM300m15<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MCEM/outMCEM300m15.csv")
outputMCEM600m15<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MCEM/outMCEM600m15.csv")
outputMCEM1000m15<- read.csv("C:/Users/sh_za/OneDrive/Desktop/Results/Univariate/MCEM/outMCEM1000m15.csv")



outputMCEM50m15<- outputMCEM50m15[,-1]
outputMCEM100m15<- outputMCEM100m15[,-1]
outputMCEM300m15<- outputMCEM300m15[,-1]
outputMCEM600m15<- outputMCEM600m15[,-1]
outputMCEM1000m15<- outputMCEM1000m15[,-1]
#######################################################################################################################
#######################################################################################################################
### EM RESULTS####
### N=1000###
se_EM_1000<- matrix(rep(0,2*nrow(outputEM1000m15)),ncol=2)

for(i in 1:nrow(outputEM1000m15)){
  se_EM_1000[i,]<- Muvarstd(thetaupd=c(outputEM1000m15[i,1],sqrt(outputEM1000m15[i,2])),
                            bl=simdata1000m15[,1,i],bu=simdata1000m15[,2,i],Freq=simdata1000m15[,3,i],Data=simdata1000m15[,,i])
  
}

#se_EM_1000
#se_EM_1000[1:5,]

#se_MCEM1000m15[1:5,]

CI_mu_1000<- matrix(rep(0,2*nrow(outputEM1000m15)),nrow=nrow(outputEM1000m15),ncol=2)
colnames(CI_mu_1000)<- c("Lower bound","Upper bound")

for(i in 1:nrow(outputEM1000m15)){
  CI_mu_1000[i,1]<- outputEM1000m15[i,1]-(se_EM_1000[i,1]*qnorm(0.975))
  CI_mu_1000[i,2]<- outputEM1000m15[i,1]+(se_EM_1000[i,1]*qnorm(0.975))
  
}

#CI_mu_1000

CI_sigma2_1000<- matrix(rep(0,2*nrow(outputEM1000m15)),nrow=nrow(outputEM1000m15),ncol=2)
colnames(CI_sigma2_1000)<- c("Lower bound","Upper bound")


for(i in 1:nrow(outputEM1000m15)){
  CI_sigma2_1000[i,1]<- outputEM1000m15[i,2]-(se_EM_1000[i,2]*qnorm(0.975))
  CI_sigma2_1000[i,2]<- outputEM1000m15[i,2]+(se_EM_1000[i,2]*qnorm(0.975))
  
}
#CI_sigma2_1000

true_mu<- 68
true_sigma2<- (2.5)^2
#true_sigma2


Empirical_conf_mu_1000<- 0
Empirical_conf_sigma2_1000<- 0

for(i in 1:nrow(outputEM1000m15)){
  if(true_mu>=CI_mu_1000[i,1] & true_mu<=CI_mu_1000[i,2]) Empirical_conf_mu_1000<- Empirical_conf_mu_1000+1
  
  if(true_sigma2>=CI_sigma2_1000[i,1] & true_sigma2<=CI_sigma2_1000[i,2]) Empirical_conf_sigma2_1000<- Empirical_conf_sigma2_1000+1
}


Empirical_conf_mu_1000/500
Empirical_conf_sigma2_1000/500
############################################################################################################################
### N=50###
se_EM_50<- matrix(rep(0,2*nrow(outputEM50m15)),ncol=2)

for(i in 1:nrow(outputEM50m15)){
  se_EM_50[i,]<- Muvarstd(thetaupd=c(outputEM50m15[i,1],sqrt(outputEM50m15[i,2])),
                          bl=simdata50m15[,1,i],bu=simdata50m15[,2,i],Freq=simdata50m15[,3,i],Data=simdata50m15[,,i])
  
}
#se_EM_50

CI_mu_50<- matrix(rep(0,2*nrow(outputEM50m15)),nrow=nrow(outputEM50m15),ncol=2)
colnames(CI_mu_50)<- c("Lower bound","Upper bound")

for(i in 1:nrow(outputEM50m15)){
  CI_mu_50[i,1]<- outputEM50m15[i,1]-(se_EM_50[i,1]*qnorm(0.975))
  CI_mu_50[i,2]<- outputEM50m15[i,1]+(se_EM_50[i,1]*qnorm(0.975))
  
}

#CI_mu_100

CI_sigma2_50<- matrix(rep(0,2*nrow(outputEM50m15)),nrow=nrow(outputEM50m15),ncol=2)
colnames(CI_sigma2_50)<- c("Lower bound","Upper bound")


for(i in 1:nrow(outputEM50m15)){
  CI_sigma2_50[i,1]<- outputEM50m15[i,2]-(se_EM_50[i,2]*qnorm(0.975))
  CI_sigma2_50[i,2]<- outputEM50m15[i,2]+(se_EM_50[i,2]*qnorm(0.975))
  
}
#CI_sigma2_100

true_mu<- 68
true_sigma2<- (2.5)^2
#true_sigma2


Empirical_conf_mu_50<- 0
Empirical_conf_sigma2_50<- 0

for(i in 1:nrow(outputEM50m15)){
  if(true_mu>=CI_mu_50[i,1] & true_mu<=CI_mu_50[i,2]) Empirical_conf_mu_50<- Empirical_conf_mu_50+1
  
  if(true_sigma2>=CI_sigma2_50[i,1] & true_sigma2<=CI_sigma2_50[i,2]) 
    Empirical_conf_sigma2_50<- Empirical_conf_sigma2_50+1
}


Empirical_conf_mu_50/500
Empirical_conf_sigma2_50/500
########################################################################################################################
### N=100##
se_EM_100<- matrix(rep(0,2*nrow(outputEM100m15)),ncol=2)

for(i in 1:nrow(outputEM100m15)){
  se_EM_100[i,]<- Muvarstd(thetaupd=c(outputEM100m15[i,1],sqrt(outputEM100m15[i,2])),
                           bl=simdata100m15[,1,i],bu=simdata100m15[,2,i],Freq=simdata100m15[,3,i],Data=simdata100m15[,,i])
  
}
#se_EM_100

CI_mu_100<- matrix(rep(0,2*nrow(outputEM100m15)),nrow=nrow(outputEM100m15),ncol=2)
colnames(CI_mu_100)<- c("Lower bound","Upper bound")

for(i in 1:nrow(outputEM100m15)){
  CI_mu_100[i,1]<- outputEM100m15[i,1]-(se_EM_100[i,1]*qnorm(0.975))
  CI_mu_100[i,2]<- outputEM100m15[i,1]+(se_EM_100[i,1]*qnorm(0.975))
  
}

#CI_mu_100

CI_sigma2_100<- matrix(rep(0,2*nrow(outputEM100m15)),nrow=nrow(outputEM100m15),ncol=2)
colnames(CI_sigma2_100)<- c("Lower bound","Upper bound")


for(i in 1:nrow(outputEM100m15)){
  CI_sigma2_100[i,1]<- outputEM100m15[i,2]-(se_EM_100[i,2]*qnorm(0.975))
  CI_sigma2_100[i,2]<- outputEM100m15[i,2]+(se_EM_100[i,2]*qnorm(0.975))
  
}
#CI_sigma2_100

true_mu<- 68
true_sigma2<- (2.5)^2
#true_sigma2


Empirical_conf_mu_100<- 0
Empirical_conf_sigma2_100<- 0

for(i in 1:nrow(outputEM100m15)){
  if(true_mu>=CI_mu_100[i,1] & true_mu<=CI_mu_100[i,2]) Empirical_conf_mu_100<- Empirical_conf_mu_100+1
  
  if(true_sigma2>=CI_sigma2_100[i,1] & true_sigma2<=CI_sigma2_100[i,2]) 
    Empirical_conf_sigma2_100<- Empirical_conf_sigma2_100+1
}


Empirical_conf_mu_100/500
Empirical_conf_sigma2_100/500
###################################################################################################################
### N=300###
se_EM_300<- matrix(rep(0,2*nrow(outputEM300m15)),ncol=2)

for(i in 1:nrow(outputEM300m15)){
  se_EM_300[i,]<- Muvarstd(thetaupd=c(outputEM300m15[i,1],sqrt(outputEM300m15[i,2])),
                           bl=simdata300m15[,1,i],bu=simdata300m15[,2,i],Freq=simdata300m15[,3,i],Data=simdata300m15[,,i])
  
}
#se_EM_300

CI_mu_300<- matrix(rep(0,2*nrow(outputEM300m15)),nrow=nrow(outputEM300m15),ncol=2)
colnames(CI_mu_300)<- c("Lower bound","Upper bound")

for(i in 1:nrow(outputEM300m15)){
  CI_mu_300[i,1]<- outputEM300m15[i,1]-(se_EM_300[i,1]*qnorm(0.975))
  CI_mu_300[i,2]<- outputEM300m15[i,1]+(se_EM_300[i,1]*qnorm(0.975))
  
}

#CI_mu_300

CI_sigma2_300<- matrix(rep(0,2*nrow(outputEM300m15)),nrow=nrow(outputEM300m15),ncol=2)
colnames(CI_sigma2_300)<- c("Lower bound","Upper bound")


for(i in 1:nrow(outputEM300m15)){
  CI_sigma2_300[i,1]<- outputEM300m15[i,2]-(se_EM_300[i,2]*qnorm(0.975))
  CI_sigma2_300[i,2]<- outputEM300m15[i,2]+(se_EM_300[i,2]*qnorm(0.975))
  
}
#CI_sigma2_100

true_mu<- 68
true_sigma2<- (2.5)^2
#true_sigma2


Empirical_conf_mu_300<- 0
Empirical_conf_sigma2_300<- 0

for(i in 1:nrow(outputEM300m15)){
  if(true_mu>=CI_mu_300[i,1] & true_mu<=CI_mu_300[i,2]) Empirical_conf_mu_300<- Empirical_conf_mu_300+1
  
  if(true_sigma2>=CI_sigma2_300[i,1] & true_sigma2<=CI_sigma2_300[i,2]) 
    Empirical_conf_sigma2_300<- Empirical_conf_sigma2_300+1
}


Empirical_conf_mu_300/500
Empirical_conf_sigma2_300/500
##################################################################################################################
###N=600###
se_EM_600<- matrix(rep(0,2*nrow(outputEM600m15)),ncol=2)

for(i in 1:nrow(outputEM600m15)){
  se_EM_600[i,]<- Muvarstd(thetaupd=c(outputEM600m15[i,1],sqrt(outputEM600m15[i,2])),
                           bl=simdata600m15[,1,i],bu=simdata600m15[,2,i],Freq=simdata600m15[,3,i],Data=simdata600m15[,,i])
  
}
#se_EM_600

CI_mu_600<- matrix(rep(0,2*nrow(outputEM600m15)),nrow=nrow(outputEM600m15),ncol=2)
colnames(CI_mu_600)<- c("Lower bound","Upper bound")

for(i in 1:nrow(outputEM600m15)){
  CI_mu_600[i,1]<- outputEM600m15[i,1]-(se_EM_600[i,1]*qnorm(0.975))
  CI_mu_600[i,2]<- outputEM600m15[i,1]+(se_EM_600[i,1]*qnorm(0.975))
  
}

#CI_mu_600

CI_sigma2_600<- matrix(rep(0,2*nrow(outputEM600m15)),nrow=nrow(outputEM600m15),ncol=2)
colnames(CI_sigma2_600)<- c("Lower bound","Upper bound")


for(i in 1:nrow(outputEM600m15)){
  CI_sigma2_600[i,1]<- outputEM600m15[i,2]-(se_EM_600[i,2]*qnorm(0.975))
  CI_sigma2_600[i,2]<- outputEM600m15[i,2]+(se_EM_600[i,2]*qnorm(0.975))
  
}
#CI_sigma2_100

true_mu<- 68
true_sigma2<- (2.5)^2
#true_sigma2


Empirical_conf_mu_600<- 0
Empirical_conf_sigma2_600<- 0

for(i in 1:nrow(outputEM600m15)){
  if(true_mu>=CI_mu_600[i,1] & true_mu<=CI_mu_600[i,2]) Empirical_conf_mu_600<- Empirical_conf_mu_600+1
  
  if(true_sigma2>=CI_sigma2_600[i,1] & true_sigma2<=CI_sigma2_600[i,2]) 
    Empirical_conf_sigma2_600<- Empirical_conf_sigma2_600+1
}


Empirical_conf_mu_600/500
Empirical_conf_sigma2_600/500

################################################################################################################
################################################################################################################

EMP_Conf_Mu_prop<- c(Empirical_conf_mu_50/500,Empirical_conf_mu_100/500,Empirical_conf_mu_300/500,
                     Empirical_conf_mu_600/500,Empirical_conf_mu_1000/500)


EMP_Conf_sigma2_prop<- c(Empirical_conf_sigma2_50/500,Empirical_conf_sigma2_100/500,Empirical_conf_sigma2_300/500,
                         Empirical_conf_sigma2_600/500,Empirical_conf_sigma2_1000/500)

print(EMP_Conf_Mu_prop*100)
print(EMP_Conf_sigma2_prop*100)

##################################
n<- c(50,100,300,600,1000)
EMP_CI_MU_Prop<- EMP_Conf_Mu_prop*100
EMP_CI_Sigma2_Prop<- EMP_Conf_sigma2_prop*100
EMP_CI_MU_Prop
EMP_CI_Sigma2_Prop

sd_MU<- c(sd(outputEM50m15[,1]),sd(outputEM100m15[,1]),sd(outputEM300m15[,1]),
          sd(outputEM600m15[,1]),sd(outputEM1000m15[,1]))
sd_MU

ave_MU<- c(mean(outputEM50m15[,1]),mean(outputEM100m15[,1]),mean(outputEM300m15[,1]),
           mean(outputEM600m15[,1]),mean(outputEM1000m15[,1]))
ave_MU

Se_MU_hat<- c(mean(se_EM_50[,1]),mean(se_EM_100[,1]),mean(se_EM_300[,1]),mean(se_EM_600[,1]),mean(se_EM_1000[,1]))
Se_MU_hat

sd_var<- c(sd(outputEM50m15[,2]),sd(outputEM100m15[,2]),sd(outputEM300m15[,2]),
           sd(outputEM600m15[,2]),sd(outputEM1000m15[,2]))
sd_var

Ave_var<- c(mean(outputEM50m15[,2]),mean(outputEM100m15[,2]),mean(outputEM300m15[,2]),
            mean(outputEM600m15[,2]),mean(outputEM1000m15[,2]))
Ave_var

Se_Sigma2_hat<-  c(mean(se_EM_50[,2]),mean(se_EM_100[,2]),mean(se_EM_300[,2]),mean(se_EM_600[,2]),mean(se_EM_1000[,2]))
Se_Sigma2_hat
####################################################################################################################
std_Mu_estimates<- cbind(n,ave_MU,sd_MU,Se_MU_hat,EMP_CI_MU_Prop)
std_Mu_estimates

std_Sigma2_estimates<- cbind(n,Ave_var,sd_var,Se_Sigma2_hat,EMP_CI_Sigma2_Prop)
std_Sigma2_estimates

library(xtable)
xtable(std_Mu_estimates,digits=6)
xtable(std_Sigma2_estimates,digits=6)

#######################################################################################################################
########################################################################################################################
#### MCEM RESULTS####
outputMCEM1000m15

theta1000<-matrix(rep(0,2*nrow(outputMCEM1000m15)),ncol=2)
for(i in 1:nrow(outputMCEM1000m15)){
  theta1000[i,]<- c(outputMCEM1000m15[i,1],sqrt(outputMCEM1000m15[i,2]))
}
theta1000


se_MCEM1000m15<- matrix(rep(0,2*nrow(outputMCEM1000m15)),ncol=2)
for(i in 1:nrow(outputMCEM1000m15)){
  se_MCEM1000m15[i,]<-  ZsimMCEM(theta1000[i,],data=simdata1000m15[,,i])
}
se_MCEM1000m15
se_MCEM1000m15[1:5,]
se_EM_1000[1:5,]
trueval<- c(68,(2.5)^2)
#########################################################################################
CI_mu_1000_MCEM<- matrix(rep(0,2*nrow(outputMCEM1000m15)),nrow=nrow(outputMCEM1000m15),ncol=2)
colnames(CI_mu_1000_MCEM)<- c("Lower bound","Upper bound")

for(i in 1:nrow(outputMCEM1000m15)){
  CI_mu_1000_MCEM[i,1]<- outputMCEM1000m15[i,1]-(se_MCEM1000m15[i,1]*qnorm(0.975))
  CI_mu_1000_MCEM[i,2]<- outputMCEM1000m15[i,1]+(se_MCEM1000m15[i,1]*qnorm(0.975))
  
}

CI_mu_1000_MCEM

CI_sigma2_1000_MCEM<- matrix(rep(0,2*nrow(outputMCEM1000m15)),nrow=nrow(outputMCEM1000m15),ncol=2)
colnames(CI_sigma2_1000_MCEM)<- c("Lower bound","Upper bound")


for(i in 1:nrow(outputMCEM1000m15)){
  CI_sigma2_1000_MCEM[i,1]<- outputMCEM1000m15[i,2]-(se_MCEM1000m15[i,2]*qnorm(0.975))
  CI_sigma2_1000_MCEM[i,2]<- outputMCEM1000m15[i,2]+(se_MCEM1000m15[i,2]*qnorm(0.975))
  
}
CI_sigma2_1000_MCEM

true_mu<- 68
true_sigma2<- (2.5)^2
#true_sigma2


Empirical_conf_mu_1000_MCEM<- 0
Empirical_conf_sigma2_1000_MCEM<- 0

for(i in 1:nrow(outputMCEM1000m15)){
  if(true_mu>=CI_mu_1000_MCEM[i,1] & true_mu<=CI_mu_1000_MCEM[i,2]) Empirical_conf_mu_1000_MCEM<- Empirical_conf_mu_1000_MCEM+1
  
  if(true_sigma2>=CI_sigma2_1000_MCEM[i,1] & true_sigma2<=CI_sigma2_1000_MCEM[i,2]) 
    Empirical_conf_sigma2_1000_MCEM<- Empirical_conf_sigma2_1000_MCEM+1
}


Empirical_conf_mu_1000_MCEM/500
Empirical_conf_sigma2_1000_MCEM/500
###############################################################################################################################
################################################################################################################################
outputMCEM50m15

theta50<-matrix(rep(0,2*nrow(outputMCEM50m15)),ncol=2)
for(i in 1:nrow(outputMCEM50m15)){
  theta50[i,]<- c(outputMCEM50m15[i,1],sqrt(outputMCEM50m15[i,2]))
}
theta50


se_MCEM50m15<- matrix(rep(0,2*nrow(outputMCEM50m15)),ncol=2)
for(i in 1:nrow(outputMCEM50m15)){
  se_MCEM50m15[i,]<-  ZsimMCEM(theta50[i,],data=simdata50m15[,,i])
}
se_MCEM50m15
se_MCEM50m15[1:5,]
#se_EM_1000[1:5,]
trueval<- c(68,(2.5)^2)
#########################################################################################
CI_mu_50_MCEM<- matrix(rep(0,2*nrow(outputMCEM50m15)),nrow=nrow(outputMCEM50m15),ncol=2)
colnames(CI_mu_50_MCEM)<- c("Lower bound","Upper bound")

for(i in 1:nrow(outputMCEM50m15)){
  CI_mu_50_MCEM[i,1]<- outputMCEM50m15[i,1]-(se_MCEM50m15[i,1]*qnorm(0.975))
  CI_mu_50_MCEM[i,2]<- outputMCEM50m15[i,1]+(se_MCEM50m15[i,1]*qnorm(0.975))
  
}

CI_mu_50_MCEM

CI_sigma2_50_MCEM<- matrix(rep(0,2*nrow(outputMCEM50m15)),nrow=nrow(outputMCEM50m15),ncol=2)
colnames(CI_sigma2_50_MCEM)<- c("Lower bound","Upper bound")


for(i in 1:nrow(outputMCEM50m15)){
  CI_sigma2_50_MCEM[i,1]<- outputMCEM50m15[i,2]-(se_MCEM50m15[i,2]*qnorm(0.975))
  CI_sigma2_50_MCEM[i,2]<- outputMCEM50m15[i,2]+(se_MCEM50m15[i,2]*qnorm(0.975))
  
}
CI_sigma2_50_MCEM

true_mu<- 68
true_sigma2<- (2.5)^2
#true_sigma2


Empirical_conf_mu_50_MCEM<- 0
Empirical_conf_sigma2_50_MCEM<- 0

for(i in 1:nrow(outputMCEM50m15)){
  if(true_mu>=CI_mu_50_MCEM[i,1] & true_mu<=CI_mu_50_MCEM[i,2]) Empirical_conf_mu_50_MCEM<- Empirical_conf_mu_50_MCEM+1
  
  if(true_sigma2>=CI_sigma2_50_MCEM[i,1] & true_sigma2<=CI_sigma2_50_MCEM[i,2]) 
    Empirical_conf_sigma2_50_MCEM<- Empirical_conf_sigma2_50_MCEM+1
}


Empirical_conf_mu_50_MCEM/500
Empirical_conf_sigma2_50_MCEM/500
###############################################################################################################################
################################################################################################################################
outputMCEM100m15

theta100<-matrix(rep(0,2*nrow(outputMCEM100m15)),ncol=2)
for(i in 1:nrow(outputMCEM100m15)){
  theta100[i,]<- c(outputMCEM100m15[i,1],sqrt(outputMCEM100m15[i,2]))
}
theta100


se_MCEM100m15<- matrix(rep(0,2*nrow(outputMCEM100m15)),ncol=2)
for(i in 1:nrow(outputMCEM100m15)){
  se_MCEM100m15[i,]<-  ZsimMCEM(theta100[i,],data=simdata100m15[,,i])
}
se_MCEM100m15
se_MCEM100m15[1:5,]
#se_EM_1000[1:5,]
#trueval<- c(68,(2.5)^2)
#########################################################################################
CI_mu_100_MCEM<- matrix(rep(0,2*nrow(outputMCEM100m15)),nrow=nrow(outputMCEM100m15),ncol=2)
colnames(CI_mu_100_MCEM)<- c("Lower bound","Upper bound")

for(i in 1:nrow(outputMCEM100m15)){
  CI_mu_100_MCEM[i,1]<- outputMCEM100m15[i,1]-(se_MCEM100m15[i,1]*qnorm(0.975))
  CI_mu_100_MCEM[i,2]<- outputMCEM100m15[i,1]+(se_MCEM100m15[i,1]*qnorm(0.975))
  
}

CI_mu_100_MCEM

CI_sigma2_100_MCEM<- matrix(rep(0,2*nrow(outputMCEM100m15)),nrow=nrow(outputMCEM100m15),ncol=2)
colnames(CI_sigma2_100_MCEM)<- c("Lower bound","Upper bound")


for(i in 1:nrow(outputMCEM100m15)){
  CI_sigma2_100_MCEM[i,1]<- outputMCEM100m15[i,2]-(se_MCEM100m15[i,2]*qnorm(0.975))
  CI_sigma2_100_MCEM[i,2]<- outputMCEM100m15[i,2]+(se_MCEM100m15[i,2]*qnorm(0.975))
  
}
CI_sigma2_100_MCEM

true_mu<- 68
true_sigma2<- (2.5)^2
#true_sigma2


Empirical_conf_mu_100_MCEM<- 0
Empirical_conf_sigma2_100_MCEM<- 0

for(i in 1:nrow(outputMCEM100m15)){
  if(true_mu>=CI_mu_100_MCEM[i,1] & true_mu<=CI_mu_100_MCEM[i,2]) Empirical_conf_mu_100_MCEM<- Empirical_conf_mu_100_MCEM+1
  
  if(true_sigma2>=CI_sigma2_100_MCEM[i,1] & true_sigma2<=CI_sigma2_100_MCEM[i,2]) 
    Empirical_conf_sigma2_100_MCEM<- Empirical_conf_sigma2_100_MCEM+1
}


Empirical_conf_mu_100_MCEM/500
Empirical_conf_sigma2_100_MCEM/500
###############################################################################################################################
###############################################################################################################################
################################################################################################################################
outputMCEM300m15

theta300<-matrix(rep(0,2*nrow(outputMCEM300m15)),ncol=2)
for(i in 1:nrow(outputMCEM300m15)){
  theta300[i,]<- c(outputMCEM300m15[i,1],sqrt(outputMCEM300m15[i,2]))
}
theta300


se_MCEM300m15<- matrix(rep(0,2*nrow(outputMCEM300m15)),ncol=2)
for(i in 1:nrow(outputMCEM300m15)){
  se_MCEM300m15[i,]<-  ZsimMCEM(theta300[i,],data=simdata300m15[,,i])
}
se_MCEM300m15
se_MCEM300m15[1:5,]
#se_EM_1000[1:5,]
#trueval<- c(68,(2.5)^2)
#########################################################################################
CI_mu_300_MCEM<- matrix(rep(0,2*nrow(outputMCEM300m15)),nrow=nrow(outputMCEM300m15),ncol=2)
colnames(CI_mu_300_MCEM)<- c("Lower bound","Upper bound")

for(i in 1:nrow(outputMCEM300m15)){
  CI_mu_300_MCEM[i,1]<- outputMCEM300m15[i,1]-(se_MCEM300m15[i,1]*qnorm(0.975))
  CI_mu_300_MCEM[i,2]<- outputMCEM300m15[i,1]+(se_MCEM300m15[i,1]*qnorm(0.975))
  
}

CI_mu_300_MCEM

CI_sigma2_300_MCEM<- matrix(rep(0,2*nrow(outputMCEM300m15)),nrow=nrow(outputMCEM300m15),ncol=2)
colnames(CI_sigma2_300_MCEM)<- c("Lower bound","Upper bound")


for(i in 1:nrow(outputMCEM300m15)){
  CI_sigma2_300_MCEM[i,1]<- outputMCEM300m15[i,2]-(se_MCEM300m15[i,2]*qnorm(0.975))
  CI_sigma2_300_MCEM[i,2]<- outputMCEM300m15[i,2]+(se_MCEM300m15[i,2]*qnorm(0.975))
  
}
CI_sigma2_300_MCEM

true_mu<- 68
true_sigma2<- (2.5)^2
#true_sigma2


Empirical_conf_mu_300_MCEM<- 0
Empirical_conf_sigma2_300_MCEM<- 0

for(i in 1:nrow(outputMCEM300m15)){
  if(true_mu>=CI_mu_300_MCEM[i,1] & true_mu<=CI_mu_300_MCEM[i,2]) Empirical_conf_mu_300_MCEM<- Empirical_conf_mu_300_MCEM+1
  
  if(true_sigma2>=CI_sigma2_300_MCEM[i,1] & true_sigma2<=CI_sigma2_300_MCEM[i,2]) 
    Empirical_conf_sigma2_300_MCEM<- Empirical_conf_sigma2_300_MCEM+1
}


Empirical_conf_mu_300_MCEM/500
Empirical_conf_sigma2_300_MCEM/500
###############################################################################################################################
################################################################################################################################
outputMCEM600m15

theta600<-matrix(rep(0,2*nrow(outputMCEM600m15)),ncol=2)
for(i in 1:nrow(outputMCEM600m15)){
  theta600[i,]<- c(outputMCEM600m15[i,1],sqrt(outputMCEM600m15[i,2]))
}
theta600


se_MCEM600m15<- matrix(rep(0,2*nrow(outputMCEM600m15)),ncol=2)
for(i in 1:nrow(outputMCEM600m15)){
  se_MCEM600m15[i,]<-  ZsimMCEM(theta600[i,],data=simdata600m15[,,i])
}
se_MCEM600m15
se_MCEM600m15[1:5,]
#se_EM_1000[1:5,]
#trueval<- c(68,(2.5)^2)
#########################################################################################
CI_mu_600_MCEM<- matrix(rep(0,2*nrow(outputMCEM600m15)),nrow=nrow(outputMCEM600m15),ncol=2)
colnames(CI_mu_600_MCEM)<- c("Lower bound","Upper bound")

for(i in 1:nrow(outputMCEM600m15)){
  CI_mu_600_MCEM[i,1]<- outputMCEM600m15[i,1]-(se_MCEM600m15[i,1]*qnorm(0.975))
  CI_mu_600_MCEM[i,2]<- outputMCEM600m15[i,1]+(se_MCEM600m15[i,1]*qnorm(0.975))
  
}

CI_mu_600_MCEM

CI_sigma2_600_MCEM<- matrix(rep(0,2*nrow(outputMCEM600m15)),nrow=nrow(outputMCEM600m15),ncol=2)
colnames(CI_sigma2_600_MCEM)<- c("Lower bound","Upper bound")


for(i in 1:nrow(outputMCEM600m15)){
  CI_sigma2_600_MCEM[i,1]<- outputMCEM600m15[i,2]-(se_MCEM600m15[i,2]*qnorm(0.975))
  CI_sigma2_600_MCEM[i,2]<- outputMCEM600m15[i,2]+(se_MCEM600m15[i,2]*qnorm(0.975))
  
}
CI_sigma2_600_MCEM

true_mu<- 68
true_sigma2<- (2.5)^2
#true_sigma2


Empirical_conf_mu_600_MCEM<- 0
Empirical_conf_sigma2_600_MCEM<- 0

for(i in 1:nrow(outputMCEM600m15)){
  if(true_mu>=CI_mu_600_MCEM[i,1] & true_mu<=CI_mu_600_MCEM[i,2]) Empirical_conf_mu_600_MCEM<- Empirical_conf_mu_600_MCEM+1
  
  if(true_sigma2>=CI_sigma2_600_MCEM[i,1] & true_sigma2<=CI_sigma2_600_MCEM[i,2]) 
    Empirical_conf_sigma2_600_MCEM<- Empirical_conf_sigma2_600_MCEM+1
}


Empirical_conf_mu_600_MCEM/500
Empirical_conf_sigma2_600_MCEM/500
######################################################################################################################
######################################################################################################################
###############################################################################################################
################################################################################################################

Conf_Mu_prop_MCEM<- c(Empirical_conf_mu_50_MCEM/500,Empirical_conf_mu_100_MCEM/500,Empirical_conf_mu_300_MCEM/500,
                      Empirical_conf_mu_600_MCEM/500,Empirical_conf_mu_1000_MCEM/500)


Conf_sigma2_prop_MCEM<- c(Empirical_conf_sigma2_50_MCEM/500,Empirical_conf_sigma2_100_MCEM/500,Empirical_conf_sigma2_300_MCEM/500,
                          Empirical_conf_sigma2_600_MCEM/500,Empirical_conf_sigma2_1000_MCEM/500)

print(Conf_Mu_prop_MCEM*100)
print(Conf_sigma2_prop_MCEM*100)

##################################
n<- c(50,100,300,600,1000)
CI_MU_Prop_MCEM<- Conf_Mu_prop_MCEM*100
CI_Sigma2_Prop_MCEM<- Conf_sigma2_prop_MCEM*100
CI_MU_Prop_MCEM
CI_Sigma2_Prop_MCEM


outputMCEM1000m15
sd_MU_MCEM<- c(sd(outputMCEM50m15[,1]),sd(outputMCEM100m15[,1]),sd(outputMCEM300m15[,1]),
               sd(outputMCEM600m15[,1]),sd(outputMCEM1000m15[,1]))
sd_MU_MCEM

AVE_MU_MCEM<- c(mean(outputMCEM50m15[,1]),mean(outputMCEM100m15[,1]),mean(outputMCEM300m15[,1]),
                mean(outputMCEM600m15[,1]),mean(outputMCEM1000m15[,1]))
AVE_MU_MCEM


Se_MU_hat_MCEM<- c(mean(se_MCEM50m15[,1]),mean(se_MCEM100m15[,1]),mean(se_MCEM300m15[,1]),
                   mean(se_MCEM600m15[,1]),mean(se_MCEM1000m15[,1]))
Se_MU_hat_MCEM

sd_var_MCEM<- c(sd(outputMCEM50m15[,2]),sd(outputMCEM100m15[,2]),sd(outputMCEM300m15[,2]),
                sd(outputMCEM600m15[,2]),sd(outputMCEM1000m15[,2]))
sd_var_MCEM

Ave_var_MCEM<- c(mean(outputMCEM50m15[,2]),mean(outputMCEM100m15[,2]),mean(outputMCEM300m15[,2]),
                 mean(outputMCEM600m15[,2]),mean(outputMCEM1000m15[,2]))
Ave_var_MCEM

Se_Sigma2_hat_MCEM<-  c(mean(se_MCEM50m15[,2]),mean(se_MCEM100m15[,2]),mean(se_MCEM300m15[,2]),
                        mean(se_MCEM600m15[,2]),mean(se_MCEM1000m15[,2]))
Se_Sigma2_hat_MCEM
##########################################################################################################################################
#######################################################################################################################
std_Mu_estimates_MCEM<- cbind(n,AVE_MU_MCEM,sd_MU_MCEM,Se_MU_hat_MCEM,CI_MU_Prop_MCEM)
std_Mu_estimates_MCEM

std_Sigma2_estimates_MCEM<- cbind(n,Ave_var_MCEM,sd_var_MCEM,Se_Sigma2_hat_MCEM,CI_Sigma2_Prop_MCEM)
std_Sigma2_estimates_MCEM

library(xtable)
xtable(std_Mu_estimates_MCEM,digits=6)
xtable(std_Sigma2_estimates_MCEM,digits=6)
#########################################################################################################################
###########################################################################################################################
sample_size<- c(50,50,100,100,300,300,600,600,1000,1000)
Method<- rep(c("EM","MCEM"),5) 



Ave_MUs<- c(mean(outputEM50m15[,1]),mean(outputMCEM50m15[,1]),
  mean(outputEM100m15[,1]),mean(outputMCEM100m15[,1]),
  mean(outputEM300m15[,1]),mean(outputMCEM300m15[,1]),
  mean(outputEM600m15[,1]),mean(outputMCEM600m15[,1]),
  mean(outputEM1000m15[,1]),mean(outputMCEM1000m15[,1]))

Ave_MUs

Ave_VArs<- c(mean(outputEM50m15[,2]),mean(outputMCEM50m15[,2]),
            mean(outputEM100m15[,2]),mean(outputMCEM100m15[,2]),
            mean(outputEM300m15[,2]),mean(outputMCEM300m15[,2]),
            mean(outputEM600m15[,2]),mean(outputMCEM600m15[,2]),
            mean(outputEM1000m15[,2]),mean(outputMCEM1000m15[,2]))

Ave_VArs


std_MUs<- c(sd(outputEM50m15[,1]),sd(outputMCEM50m15[,1]),
            sd(outputEM100m15[,1]),sd(outputMCEM100m15[,1]),
            sd(outputEM300m15[,1]),sd(outputMCEM300m15[,1]),
          sd(outputEM600m15[,1]), sd(outputMCEM600m15[,1]),
          sd(outputEM1000m15[,1]),sd(outputMCEM1000m15[,1]))

std_MUs

std_Vars<- c(sd(outputEM50m15[,2]),sd(outputMCEM50m15[,2]),
            sd(outputEM100m15[,2]),sd(outputMCEM100m15[,2]),
            sd(outputEM300m15[,2]),sd(outputMCEM300m15[,2]),
            sd(outputEM600m15[,2]), sd(outputMCEM600m15[,2]),
            sd(outputEM1000m15[,2]),sd(outputMCEM1000m15[,2]))

std_Vars

se_mu_est<- c(mean(se_EM_50[,1]),mean(se_MCEM50m15[,1]),
              mean(se_EM_100[,1]),mean(se_MCEM100m15[,1]),
              mean(se_EM_300[,1]),mean(se_MCEM300m15[,1]),
              mean(se_EM_600[,1]),mean(se_MCEM600m15[,1]),
              mean(se_EM_1000[,1]),mean(se_MCEM1000m15[,1]))
se_mu_est

se_var_est<- c(mean(se_EM_50[,2]),mean(se_MCEM50m15[,2]),
              mean(se_EM_100[,2]),mean(se_MCEM100m15[,2]),
              mean(se_EM_300[,2]),mean(se_MCEM300m15[,2]),
              mean(se_EM_600[,2]),mean(se_MCEM600m15[,2]),
              mean(se_EM_1000[,2]),mean(se_MCEM1000m15[,2]))

se_var_est


CI_MU_prop<- c(EMP_CI_MU_Prop[1],CI_MU_Prop_MCEM[1],
            EMP_CI_MU_Prop[2],CI_MU_Prop_MCEM[2],
            EMP_CI_MU_Prop[3],CI_MU_Prop_MCEM[3],
            EMP_CI_MU_Prop[4],CI_MU_Prop_MCEM[4],
            EMP_CI_MU_Prop[5],CI_MU_Prop_MCEM[5])

CI_MU_prop

CI_Sigma2_prop<- c(EMP_CI_Sigma2_Prop[1],CI_Sigma2_Prop_MCEM[1],
               EMP_CI_Sigma2_Prop[2],CI_Sigma2_Prop_MCEM[2],
               EMP_CI_Sigma2_Prop[3],CI_Sigma2_Prop_MCEM[3],
               EMP_CI_Sigma2_Prop[4],CI_Sigma2_Prop_MCEM[4],
               EMP_CI_Sigma2_Prop[5],CI_Sigma2_Prop_MCEM[5])


CI_Sigma2_prop




##########################################################################################################################################
#######################################################################################################################
Result_std_Mu<- as.data.frame(cbind(sample_size,Method,Ave_MUs,std_MUs,se_mu_est,CI_MU_prop))

Result_std_Mu

Result_std_var<- as.data.frame(cbind(sample_size,Method,Ave_VArs,std_Vars,se_var_est,CI_Sigma2_prop))
Result_std_var

library(xtable)
xtable(Result_std_Mu,digits=6)
xtable(Result_std_var,digits=6)
